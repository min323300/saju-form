<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë‚˜ì˜ ì‚¬ì£¼ ë¶„ì„</title>
  <link rel="stylesheet" href="style.css" />
  <style>
    /* =============================================
       ê°œì¸ì •ë³´ ë™ì˜ ì„¹ì…˜ ìŠ¤íƒ€ì¼
       ============================================= */
    .consent-section {
      background: #fdf8f0;
      border: 1.5px solid #d5c5b0;
      border-radius: 12px;
      padding: 18px 20px;
      margin-bottom: 18px;
    }

    .consent-title {
      font-size: 0.95rem;
      font-weight: 700;
      color: #5a3e2b;
      margin-bottom: 14px;
      padding-bottom: 10px;
      border-bottom: 1px solid #e8d9c5;
    }

    .consent-item {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      margin-bottom: 12px;
    }

    .consent-item:last-child {
      margin-bottom: 0;
    }

    .consent-item input[type="checkbox"] {
      width: 18px;
      height: 18px;
      min-width: 18px;
      margin-top: 2px;
      accent-color: #b5894f;
      cursor: pointer;
    }

    .consent-item label {
      font-size: 0.88rem;
      color: #555;
      line-height: 1.6;
      cursor: pointer;
    }

    .consent-item label .required-badge {
      background: #c0392b;
      color: white;
      font-size: 0.72rem;
      font-weight: 700;
      padding: 1px 6px;
      border-radius: 4px;
      margin-right: 4px;
    }

    .consent-item label .optional-badge {
      background: #7a9e7e;
      color: white;
      font-size: 0.72rem;
      font-weight: 700;
      padding: 1px 6px;
      border-radius: 4px;
      margin-right: 4px;
    }

    .consent-detail {
      font-size: 0.8rem;
      color: #999;
      margin-top: 4px;
      margin-left: 28px;
      line-height: 1.5;
    }

    .consent-toggle {
      color: #b5894f;
      font-size: 0.8rem;
      cursor: pointer;
      text-decoration: underline;
      background: none;
      border: none;
      padding: 0;
      font-family: inherit;
    }

    .consent-detail-box {
      display: none;
      background: #fff;
      border: 1px solid #e0d0bb;
      border-radius: 8px;
      padding: 12px 14px;
      margin-top: 8px;
      margin-left: 28px;
      font-size: 0.8rem;
      color: #666;
      line-height: 1.7;
    }

    .consent-detail-box.show {
      display: block;
    }

    .consent-all {
      display: flex;
      align-items: center;
      gap: 10px;
      padding-bottom: 12px;
      margin-bottom: 12px;
      border-bottom: 1px solid #e8d9c5;
    }

    .consent-all input[type="checkbox"] {
      width: 18px;
      height: 18px;
      min-width: 18px;
      accent-color: #b5894f;
      cursor: pointer;
    }

    .consent-all label {
      font-size: 0.95rem;
      font-weight: 700;
      color: #5a3e2b;
      cursor: pointer;
    }
  </style>
</head>
<body>

  <!-- ===== ì…ë ¥ í¼ ì„¹ì…˜ ===== -->
  <div id="form-section" class="container">
    <h1>ğŸ”® ë‚˜ì˜ ì‚¬ì£¼ ë¶„ì„</h1>
    <p class="subtitle">ì •ë³´ë¥¼ ì…ë ¥í•˜ì‹œë©´ AIê°€ ì‚¬ì£¼ë¥¼ ë¶„ì„í•´ ë“œë¦½ë‹ˆë‹¤.</p>

    <form id="saju-form">
      <div class="form-group">
        <label for="name">ì´ë¦„ <span class="required">*</span></label>
        <input type="text" id="name" name="name" placeholder="í™ê¸¸ë™" required />
      </div>
      <div class="form-group">
        <label for="phone">ì „í™”ë²ˆí˜¸ <span class="required">*</span></label>
        <input type="tel" id="phone" name="phone" placeholder="010-0000-0000" required />
      </div>
      <div class="form-group">
        <label for="birthdate">ìƒë…„ì›”ì¼ <span class="required">*</span></label>
        <input type="date" id="birthdate" name="birthdate" required />
      </div>
      <div class="form-group">
        <label for="birthtime">ì¶œìƒì‹œê°„</label>
        <input type="time" id="birthtime" name="birthtime" placeholder="(ì„ íƒì‚¬í•­)" />
      </div>
      <div class="form-group">
        <label>ìŒì–‘ë ¥ <span class="required">*</span></label>
        <div class="radio-group">
          <label class="radio-label"><input type="radio" name="calendar_type" value="solar" checked /> ì–‘ë ¥</label>
          <label class="radio-label"><input type="radio" name="calendar_type" value="lunar" /> ìŒë ¥</label>
        </div>
      </div>
      <div class="form-group">
        <label>ì„±ë³„ <span class="required">*</span></label>
        <div class="radio-group">
          <label class="radio-label"><input type="radio" name="gender" value="male" checked /> ë‚¨ì„±</label>
          <label class="radio-label"><input type="radio" name="gender" value="female" /> ì—¬ì„±</label>
        </div>
      </div>
      <div class="form-group">
        <label for="memo">ë©”ëª¨ (ê¶ê¸ˆí•œ ì  ë“±)</label>
        <textarea id="memo" name="memo" rows="3" placeholder="ì˜ˆ: ì˜¬í•´ ìš´ì„¸ê°€ ê¶ê¸ˆí•´ìš”"></textarea>
      </div>

      <!-- ===== âœ… ê°œì¸ì •ë³´ ë™ì˜ ì„¹ì…˜ ===== -->
      <div class="consent-section">
        <div class="consent-title">ğŸ“‹ ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš© ë™ì˜</div>

        <!-- ì „ì²´ ë™ì˜ -->
        <div class="consent-all">
          <input type="checkbox" id="consent-all" />
          <label for="consent-all">ì „ì²´ ë™ì˜í•˜ê¸°</label>
        </div>

        <!-- í•„ìˆ˜ ë™ì˜ 1 -->
        <div class="consent-item">
          <input type="checkbox" id="consent-required" required />
          <div>
            <label for="consent-required">
              <span class="required-badge">í•„ìˆ˜</span>
              ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•©ë‹ˆë‹¤
            </label>
            <div class="consent-detail">
              <button type="button" class="consent-toggle" onclick="toggleDetail('detail1')">ë‚´ìš© ë³´ê¸° â–¼</button>
              <div id="detail1" class="consent-detail-box">
                <strong>ìˆ˜ì§‘ í•­ëª©:</strong> ì´ë¦„, ì „í™”ë²ˆí˜¸, ìƒë…„ì›”ì¼, ì¶œìƒì‹œê°„, ì„±ë³„<br>
                <strong>ìˆ˜ì§‘ ëª©ì :</strong> ì‚¬ì£¼ ì˜¤í–‰ AI ë¶„ì„ ì„œë¹„ìŠ¤ ì œê³µ<br>
                <strong>ë³´ìœ  ê¸°ê°„:</strong> ì„œë¹„ìŠ¤ ì´ìš© ì¢…ë£Œ í›„ 1ë…„<br>
                <strong>ê±°ë¶€ ê¶Œë¦¬:</strong> ë™ì˜ë¥¼ ê±°ë¶€í•  ìˆ˜ ìˆìœ¼ë‚˜, ì„œë¹„ìŠ¤ ì´ìš©ì´ ì œí•œë©ë‹ˆë‹¤.
              </div>
            </div>
          </div>
        </div>

        <!-- ì„ íƒ ë™ì˜ (ë§ˆì¼€íŒ…) -->
        <div class="consent-item">
          <input type="checkbox" id="consent-marketing" />
          <div>
            <label for="consent-marketing">
              <span class="optional-badge">ì„ íƒ</span>
              ë ˆë”§í”ŒëŸ¬ìŠ¤ ë§ˆì¼€íŒ… ì •ë³´ ìˆ˜ì‹ ì— ë™ì˜í•©ë‹ˆë‹¤
            </label>
            <div class="consent-detail">
              <button type="button" class="consent-toggle" onclick="toggleDetail('detail2')">ë‚´ìš© ë³´ê¸° â–¼</button>
              <div id="detail2" class="consent-detail-box">
                <strong>í™œìš© ëª©ì :</strong> ë ˆë”§í”ŒëŸ¬ìŠ¤ ì´ë²¤íŠ¸, í• ì¸ í˜œíƒ, ì‹ ê·œ ë ˆì‹œí”¼ ì•ˆë‚´ ë¬¸ì ë°œì†¡<br>
                <strong>ìˆ˜ì‹  ì±„ë„:</strong> SMS ë¬¸ì ë©”ì‹œì§€<br>
                <strong>ë³´ìœ  ê¸°ê°„:</strong> ë™ì˜ ì² íšŒ ì‹œê¹Œì§€<br>
                <strong>ê±°ë¶€ ê¶Œë¦¬:</strong> ë™ì˜ë¥¼ ê±°ë¶€í•˜ì…”ë„ ì‚¬ì£¼ ë¶„ì„ ì„œë¹„ìŠ¤ ì´ìš©ì— ë¶ˆì´ìµì´ ì—†ìŠµë‹ˆë‹¤.<br>
                â€» ê´‘ê³ ì„± ì •ë³´ ìˆ˜ì‹  ë™ì˜ í›„ ì–¸ì œë“ ì§€ ìˆ˜ì‹  ê±°ë¶€ ê°€ëŠ¥í•©ë‹ˆë‹¤.
              </div>
            </div>
          </div>
        </div>
      </div>
      <!-- ===== ê°œì¸ì •ë³´ ë™ì˜ ì„¹ì…˜ ë ===== -->

      <button type="submit" id="submit-btn" class="btn-submit">ë¶„ì„ ì‹œì‘í•˜ê¸°</button>
    </form>
  </div>

  <!-- ===== ë¡œë”© ì„¹ì…˜ ===== -->
  <div id="loading-section" class="container hidden">
    <div class="loading-wrap">
      <div class="loading-notice">
        ğŸ”® AIê°€ ì‚¬ì£¼ë¥¼ ë¶„ì„í•˜ê³  ìˆìŠµë‹ˆë‹¤
        <span class="notice-sub">ë³¸ ì‚¬ì£¼ ë¶„ì„ì€ ì¸ìƒì˜ ì°¸ê³ ì™€ ì¬ë¯¸ë¡œ í™œìš©í•˜ëŠ” ì½˜í…ì¸ ì…ë‹ˆë‹¤</span>
      </div>
      <p id="loading-stage" class="loading-stage">ì…ë ¥ ì •ë³´ë¥¼ ì „ì†¡í•˜ê³  ìˆìŠµë‹ˆë‹¤...</p>
      <div class="progress-track">
        <div id="progress-bar" class="progress-bar"></div>
      </div>
      <p id="elapsed-time" class="elapsed-time">0ì´ˆ ê²½ê³¼</p>
      <p class="loading-hint">ë¶„ì„ì—ëŠ” ì•½ 30~60ì´ˆê°€ ì†Œìš”ë©ë‹ˆë‹¤.<br>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš” ğŸ˜Š</p>
    </div>
  </div>

  <!-- ===== ê²°ê³¼ ì„¹ì…˜ ===== -->
  <div id="result-section" class="container hidden">
    <div class="disclaimer-banner">
      âœ¨ ë³¸ ê²°ê³¼ëŠ” ì‚¬ì£¼ ì˜¤í–‰ì„ ë°”íƒ•ìœ¼ë¡œ í•œ <strong>ì¬ë¯¸ì™€ ì°¸ê³ ìš© ì½˜í…ì¸ </strong>ì…ë‹ˆë‹¤.<br>
      ì˜í•™ì  ì§„ë‹¨ì´ë‚˜ ì¸ìƒì˜ ê²°ì • ê¸°ì¤€ìœ¼ë¡œ ì‚¬ìš©í•˜ì§€ ë§ˆì„¸ìš”.
    </div>
    <div class="result-header">
      <h2>âœ¨ ì‚¬ì£¼ ë¶„ì„ ê²°ê³¼</h2>
      <p id="result-name-label" class="result-subtitle"></p>
    </div>
    <div class="result-card">
      <h3 class="card-title">ğŸ“œ ì‚¬ì£¼ ìš”ì•½</h3>
      <div id="res-summary" class="card-body"></div>
    </div>
    <div class="result-card">
      <h3 class="card-title">ğŸ’ª ê±´ê°• ì£¼ì˜ì‚¬í•­</h3>
      <div id="res-health" class="card-body"></div>
    </div>
    <div class="result-row">
      <div class="result-card half">
        <h3 class="card-title">ğŸ± ì¶”ì²œ ìŒì‹</h3>
        <div id="res-foods" class="card-body"></div>
      </div>
      <div class="result-card half">
        <h3 class="card-title">ğŸš« í”¼í•´ì•¼ í•  ìŒì‹</h3>
        <div id="res-avoid" class="card-body"></div>
      </div>
    </div>
    <div class="result-card promo-card">
      <h3 class="card-title">ğŸ›’ ë§ì¶¤ ìƒí’ˆ ì¶”ì²œ</h3>
      <div id="res-keywords" class="card-body keyword-wrap"></div>
      <div id="res-promo" class="promo-text"></div>
    </div>
    <button id="retry-btn" class="btn-retry" onclick="resetForm()">ë‹¤ì‹œ ë¶„ì„í•˜ê¸°</button>
  </div>

  <!-- ===== ì—ëŸ¬ ì„¹ì…˜ ===== -->
  <div id="error-section" class="container hidden">
    <div class="error-wrap">
      <p class="error-icon">âš ï¸</p>
      <p id="error-msg" class="error-text">ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.</p>
      <button class="btn-retry" onclick="resetForm()">ë‹¤ì‹œ ì‹œë„í•˜ê¸°</button>
    </div>
  </div>

  <script src="app.js"></script>
  <script>
    // =============================================
    // ì „ì²´ ë™ì˜ ì²´í¬ë°•ìŠ¤ ì—°ë™
    // =============================================
    document.getElementById('consent-all').addEventListener('change', function() {
      document.getElementById('consent-required').checked = this.checked;
      document.getElementById('consent-marketing').checked = this.checked;
    });

    // ê°œë³„ ì²´í¬ë°•ìŠ¤ ë³€ê²½ ì‹œ ì „ì²´ë™ì˜ ìƒíƒœ ì—…ë°ì´íŠ¸
    ['consent-required', 'consent-marketing'].forEach(function(id) {
      document.getElementById(id).addEventListener('change', function() {
        var allChecked =
          document.getElementById('consent-required').checked &&
          document.getElementById('consent-marketing').checked;
        document.getElementById('consent-all').checked = allChecked;
      });
    });

    // ìƒì„¸ ë‚´ìš© í† ê¸€
    function toggleDetail(id) {
      var el = document.getElementById(id);
      el.classList.toggle('show');
    }

    // =============================================
    // í¼ ì œì¶œ ì‹œ í•„ìˆ˜ ë™ì˜ ê²€ì‚¬
    // =============================================
    document.getElementById('saju-form').addEventListener('submit', function(e) {
      if (!document.getElementById('consent-required').checked) {
        e.preventDefault();
        e.stopImmediatePropagation();
        alert('ê°œì¸ì •ë³´ ìˆ˜ì§‘ ë° ì´ìš©ì— ë™ì˜í•´ ì£¼ì„¸ìš”. (í•„ìˆ˜)');
        return false;
      }
      // ë§ˆì¼€íŒ… ë™ì˜ ì—¬ë¶€ë¥¼ hidden inputìœ¼ë¡œ ì „ë‹¬
      var marketing = document.getElementById('consent-marketing').checked ? 'Y' : 'N';
      var input = document.createElement('input');
      input.type = 'hidden';
      input.name = 'marketing_agree';
      input.value = marketing;
      this.appendChild(input);
    }, true); // capture phaseë¡œ app.jsë³´ë‹¤ ë¨¼ì € ì‹¤í–‰
  </script>
</body>
</html>
